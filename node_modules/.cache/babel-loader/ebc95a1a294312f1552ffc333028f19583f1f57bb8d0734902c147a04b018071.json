{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nexport const fetchProducts = createAsyncThunk('products/fetchProducts', async (_, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n  try {\n    const resp = await fetch('http://localhost:3333/products/all');\n    if (!resp.ok) {\n      throw new Error('Server problem');\n    }\n    const products = await resp.json();\n    return products.map(item => {\n      var _item$discont_price;\n      return {\n        ...item,\n        finalPrice: (_item$discont_price = item.discont_price) !== null && _item$discont_price !== void 0 ? _item$discont_price : item.price,\n        show: true,\n        discount: true\n      };\n    });\n  } catch (error) {\n    return rejectWithValue(error.message);\n  }\n});\nexport const productsSlice = createSlice({\n  name: 'products',\n  initialState: {\n    data: []\n  },\n  reducers: {\n    sort: (state, _ref2) => {\n      let {\n        payload\n      } = _ref2;\n      state.data.sort((a, b) => {\n        const sortOrder = payload === 1 ? 1 : -1;\n        return sortOrder * (a.finalPrice - b.finalPrice);\n      });\n    },\n    searchByPrice: (state, _ref3) => {\n      let {\n        payload\n      } = _ref3;\n      const {\n        from,\n        to\n      } = payload;\n      state.data = state.data.map(el => ({\n        ...el,\n        show: el.finalPrice <= to && el.finalPrice >= from\n      }));\n    },\n    filterDiscount: (state, _ref4) => {\n      let {\n        payload\n      } = _ref4;\n      if (payload) {\n        state.data = state.data.map(elem => {\n          if (elem.discont_price == null) {\n            elem.discount = false;\n          }\n          return elem;\n        });\n      } else {\n        state.data = state.data.map(elem => ({\n          ...elem,\n          discount: true\n        }));\n      }\n    },\n    resetFilter: state => {\n      state.data = state.data.map(el => ({\n        ...el,\n        show: true,\n        discount: true\n      }));\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchProducts.pending, state => {\n      state.status = 'loading';\n    }).addCase(fetchProducts.fulfilled, (state, _ref5) => {\n      let {\n        payload\n      } = _ref5;\n      state.data = payload;\n      state.status = 'resolve';\n    }).addCase(fetchProducts.rejected, (state, _ref6) => {\n      let {\n        payload\n      } = _ref6;\n      state.status = 'rejected';\n      state.error = payload;\n    });\n  }\n});\nexport const {\n  sort,\n  searchByPrice,\n  filterDiscount,\n  resetFilter\n} = productsSlice.actions;\nexport default productsSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","fetchProducts","_","_ref","rejectWithValue","resp","fetch","ok","Error","products","json","map","item","_item$discont_price","finalPrice","discont_price","price","show","discount","error","message","productsSlice","name","initialState","data","reducers","sort","state","_ref2","payload","a","b","sortOrder","searchByPrice","_ref3","from","to","el","filterDiscount","_ref4","elem","resetFilter","extraReducers","builder","addCase","pending","status","fulfilled","_ref5","rejected","_ref6","actions","reducer"],"sources":["/Users/user/Documents/garden-store/src/store/slices/productsSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\n\nexport const fetchProducts = createAsyncThunk(\n    'products/fetchProducts',\n    async (_, { rejectWithValue }) => {\n        try {\n            const resp = await fetch('http://localhost:3333/products/all')\n            if (!resp.ok) {\n                throw new Error('Server problem')\n            }\n            const products = await resp.json()\n            return products.map(item => ({\n                ...item,\n                finalPrice: item.discont_price ?? item.price,\n                show: true,\n                discount: true,\n            }))\n        } catch (error) {\n            return rejectWithValue(error.message)\n        }\n\n    }\n)\n\nexport const productsSlice = createSlice({\n    name: 'products',\n    initialState: {\n        data: [],\n    },\n    reducers: {\n        sort: (state, { payload }) => {\n            state.data.sort((a, b) => {\n                const sortOrder = payload === 1 ? 1 : -1;\n                return sortOrder * (a.finalPrice - b.finalPrice);\n            })\n        },\n        searchByPrice: (state, { payload }) => {\n            const { from, to } = payload\n            state.data = state.data.map(el =>\n                ({ ...el, show: el.finalPrice <= to && el.finalPrice >= from })\n            );\n        },\n        filterDiscount: (state, { payload }) => {\n            if (payload) {\n                state.data = state.data.map(elem => {\n                    if (elem.discont_price == null) {\n                        elem.discount = false\n                    }\n                    return elem\n                })\n            } else {\n                state.data = state.data.map(elem => ({ ...elem, discount: true }))\n            }\n        },\n        resetFilter: (state) => {\n            state.data = state.data.map(el => ({ ...el, show: true, discount: true }))\n        }\n\n    },\n    extraReducers: (builder) => {\n        builder\n            .addCase(fetchProducts.pending, (state) => {\n                state.status = 'loading'\n            })\n            .addCase(fetchProducts.fulfilled, (state, { payload }) => {\n                state.data = payload\n                state.status = 'resolve'\n            })\n            .addCase(fetchProducts.rejected, (state, { payload }) => {\n                state.status = 'rejected'\n                state.error = payload\n            })\n    }\n})\n\nexport const { sort, searchByPrice, filterDiscount, resetFilter } = productsSlice.actions\n\nexport default productsSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}